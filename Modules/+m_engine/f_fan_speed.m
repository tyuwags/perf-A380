function n1 = f_fan_speed(altitude_m, ...
    isa_dev, mode)

altitudes = [-1000 3000 7000 11000 15000 19000 23000 27000 31000 35000 39000 43000];

TAT = [-60 -25 -20 -15 -10 -5 0 5 10 15 20 25 30 35 40 45 50 55 60];

thrust_MCL = [
    98.4 98.2 98.1 98.1 98.0 97.2 98.2 98.2 98.5 98.5 98.3 98.1;
    98.4 98.2 98.1 98.1 98.0 97.2 98.2 98.2 98.5 98.5 98.3 98.1;
    98.4 98.2 98.1 98.1 98.0 97.2 98.2 98.2 98.5 98.5 98.3 98.1;
    98.4 98.2 98.1 98.1 98.0 97.2 98.2 98.2 98.5 98.5 98.3 98.1;
    98.4 98.2 98.1 98.1 98.0 97.2 98.2 98.2 98.5 98.5 98.3 98.1;
    98.4 98.2 98.1 98.1 98.0 97.2 98.2 98.2 98.5 98.4 98.1 97.6;
    98.4 98.2 98.1 98.1 98.0 97.2 98.2 98.2 98.2 97.9 97.6 97.2;
    98.4 98.2 98.1 98.1 98.0 97.2 98.2 98.1 98.0 97.7 97.3 97.1;
    98.4 98.2 98.1 98.1 98.0 97.2 97.9 98.0 98.0 97.7 97.3 96.5;
    98.4 98.2 98.1 98.1 98.0 97.5 97.7 97.6 97.9 97.1 96.5 95.9;
    98.4 98.2 98.1 98.1 97.8 97.3 97.2 97.1 97.3 96.7 NaN NaN;
    98.4 98.2 95.1 98.0 98.0 97.0 96.9 96.9 96.9 NaN NaN NaN;
    98.4 96.7 94.0 98.0 97.9 96.9 96.8 96.8 96.8 NaN NaN NaN;
    98.4 94.0 95.9 98.0 97.8 96.8 96.8 96.7 NaN NaN NaN NaN;
    97.6 95.3 95.7 97.9 97.7 96.6 NaN NaN NaN NaN NaN NaN;
    93.1 94.3 94.4 97.9 97.7 NaN NaN NaN NaN NaN NaN NaN;
    92.6 92.7 93.1 98.0 NaN NaN NaN NaN NaN NaN NaN NaN;
    90.7 91.1 NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN;
    89.6 NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN;
];

thrust_DCL1 = [
    91.2 90.5 90.5 89.4 89.0 89.1 90.5 90.6 94.9 98.5 98.3 98.1;
    91.2 90.5 90.5 89.4 89.0 89.1 90.5 90.6 94.9 98.5 98.3 98.1;
    91.2 90.5 90.5 89.4 89.0 89.1 90.5 90.6 94.9 98.5 98.3 98.1;
    91.2 90.5 90.5 89.4 89.0 89.1 90.5 90.6 94.9 98.5 98.3 98.1;
    91.2 90.5 90.5 89.4 89.0 89.1 90.5 90.6 94.9 98.5 98.3 98.1;
    91.2 90.5 90.5 89.4 89.0 89.1 90.5 90.6 94.9 98.4 98.1 97.6;
    91.2 90.5 90.5 89.4 89.0 89.1 90.5 90.6 95.7 97.9 97.6 97.2;
    91.2 90.5 90.5 89.4 89.0 89.1 90.5 90.2 97.5 97.7 97.3 97.1;
    91.2 90.5 90.5 89.4 89.0 89.1 89.6 89.1 98.0 97.7 97.3 96.5;
    91.2 90.5 90.5 89.4 89.0 88.4 87.8 89.8 97.9 97.1 96.5 95.9;
    91.2 90.5 90.5 89.4 88.6 87.3 86.3 92.9 97.3 96.7 NaN NaN;
    91.2 90.5 87.5 89.2 88.5 86.8 85.9 96.9 96.9 NaN NaN NaN;
    91.2 89.1 86.2 89.0 88.0 86.3 87.9 96.8 96.8 NaN NaN NaN;
    91.2 86.5 87.9 88.8 87.7 85.9 96.8 96.7 NaN NaN NaN NaN;
    90.5 87.9 87.8 88.6 87.6 87.2 NaN NaN NaN NaN NaN NaN;
    86.3 87.1 86.8 88.9 87.9 NaN NaN NaN NaN NaN NaN NaN;
    85.7 85.4 85.4 89.0 NaN NaN NaN NaN NaN NaN NaN NaN;
    83.7 83.7 NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN;
    82.6 NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN;
];

thrust_DCL2 = [
    84.5 83.3 82.9 81.0 80.2 79.9 81.0 86.3 94.9 98.5 98.3 98.1;
    84.5 83.3 82.9 81.0 80.2 79.9 81.0 86.3 94.9 98.5 98.3 98.1;
    84.5 83.3 82.9 81.0 80.2 79.9 81.0 86.3 94.9 98.5 98.3 98.1;
    84.5 83.3 82.9 81.0 80.2 79.9 81.0 86.3 94.9 98.5 98.3 98.1;
    84.5 83.3 82.9 81.0 80.2 79.9 81.0 86.3 94.9 98.5 98.3 98.1;
    84.5 83.3 82.9 81.0 80.2 79.9 81.0 86.3 94.9 98.4 98.1 97.6;
    84.5 83.3 82.9 81.0 80.2 79.9 81.0 86.3 95.7 97.9 97.6 97.2;
    84.5 83.3 82.9 81.0 80.2 79.9 81.0 87.1 97.5 97.7 97.3 97.1;
    84.5 83.3 82.9 81.0 80.2 79.9 79.7 88.5 98.0 97.7 97.3 96.5;
    84.5 83.3 82.9 81.0 80.2 79.1 77.8 89.8 97.9 97.1 96.5 95.9;
    84.5 83.3 82.9 81.0 79.7 77.7 79.3 92.9 97.3 96.7 NaN NaN;
    84.5 83.3 80.2 80.8 79.3 77.0 82.7 96.9 96.9 NaN NaN NaN;
    84.5 82.1 79.1 80.5 78.9 76.6 87.9 96.8 96.8 NaN NaN NaN;
    84.5 79.9 80.7 80.5 78.8 79.1 96.8 96.7 NaN NaN NaN NaN;
    83.8 81.1 80.6 80.6 78.9 87.2 NaN NaN NaN NaN NaN NaN;
    79.8 80.2 79.5 80.7 80.5 NaN NaN NaN NaN NaN NaN NaN;
    79.1 78.5 78.1 80.5 NaN NaN NaN NaN NaN NaN NaN NaN;
    77.2 76.8 NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN;
    76.0 NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN;
];

thrust_DCL3 = [
    78.0 77.0 76.1 73.5 71.9 71.1 76.2 86.3 94.9 98.5 98.3 98.1;
    78.0 77.0 76.1 73.5 71.9 71.1 76.2 86.3 94.9 98.5 98.3 98.1;
    78.0 77.0 76.1 73.5 71.9 71.1 76.2 86.3 94.9 98.5 98.3 98.1;
    78.0 77.0 76.1 73.5 71.9 71.1 76.2 86.3 94.9 98.5 98.3 98.1;
    78.0 77.0 76.1 73.5 71.9 71.1 76.2 86.3 94.9 98.5 98.3 98.1;
    78.0 77.0 76.1 73.5 71.9 71.1 76.2 86.3 94.9 98.4 98.1 97.6;
    78.0 77.0 76.1 73.5 71.9 71.1 76.2 86.3 95.7 97.9 97.6 97.2;
    78.0 77.0 76.1 73.5 71.9 71.1 76.2 87.1 97.5 97.7 97.3 97.1;
    78.0 77.0 76.1 73.5 71.9 71.1 76.8 88.5 98.0 97.7 97.3 96.5;
    78.0 77.0 76.1 73.5 71.9 70.2 77.6 89.8 97.9 97.1 96.5 95.9;
    78.0 77.0 76.1 73.5 71.4 69.0 79.3 92.9 97.3 96.7 NaN NaN;
    78.0 77.0 73.6 73.3 71.3 71.2 82.7 96.9 96.9 NaN NaN NaN;
    78.0 75.8 72.7 73.2 71.1 74.3 87.9 96.8 96.8 NaN NaN NaN;
    78.0 73.6 74.0 73.1 70.9 79.1 96.8 96.7 NaN NaN NaN NaN;
    77.4 74.6 73.8 72.9 73.1 87.2 NaN NaN NaN NaN NaN NaN;
    73.6 73.7 72.7 72.9 80.5 NaN NaN NaN NaN NaN NaN NaN;
    72.9 72.0 71.3 73.6 NaN NaN NaN NaN NaN NaN NaN NaN;
    71.0 70.2 NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN;
    70.0 NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN;
];

switch mode
    case m_engine.mode.idle
        n1 = 25;
        return;
    case m_engine.mode.nmcl
        thrust = thrust_MCL;
    case m_engine.mode.dcl1
        thrust = thrust_DCL1;
    case m_engine.mode.dcl2
        thrust = thrust_DCL2;
    case m_engine.mode.dcl3
        thrust = thrust_DCL3;
    otherwise
        error("This mode isn't implemented: " + mode);
        return;
end

altitude_ft = m_convert.f_length(altitude_m, 'm', 'ft');

T = m_atmos.f_temperature(altitude_m, isa_dev) - 273.15;

n1 = interp2(altitudes, TAT, thrust, altitude_ft, T, 'linear');

end